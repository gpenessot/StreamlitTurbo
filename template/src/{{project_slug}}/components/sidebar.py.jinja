"""
Composant Sidebar - Navigation et informations latÃ©rales
"""

import streamlit as st
from datetime import datetime


def render_sidebar():
    """Affiche la sidebar avec navigation et informations."""
    
    with st.sidebar:
        # Logo/Header de l'application
        st.markdown("""
        <div style='text-align: center; padding: 1rem 0;'>
            <h1 style='margin: 0; color: #FF6B6B;'>ğŸš€</h1>
            <h3 style='margin: 0.5rem 0 0 0;'>{{ project_name }}</h3>
        </div>
        """, unsafe_allow_html=True)
        
        st.markdown("---")
        
        # Navigation principale
        st.markdown("### ğŸ§­ Navigation")
        st.markdown("""
        Utilisez le menu de pages de Streamlit pour naviguer :
        - ğŸ  **Accueil** : Page principale
        - ğŸ“Š **Dashboard** : Visualisations et analytics  
        - âš™ï¸ **Settings** : Configuration de l'app
        """)
        
        st.markdown("---")
        
        # Informations sur la session
        st.markdown("### ğŸ“Š Session info")
        
        # Informations utilisateur
        if 'user_name' in st.session_state:
            st.markdown(f"ğŸ‘¤ **Utilisateur :** {st.session_state.user_name}")
        else:
            st.markdown("ğŸ‘¤ **Utilisateur :** {{ author_name }}")
        
        # Heure de connexion simulÃ©e
        if 'session_start' not in st.session_state:
            st.session_state.session_start = datetime.now()
        
        session_duration = datetime.now() - st.session_state.session_start
        minutes = int(session_duration.total_seconds() // 60)
        seconds = int(session_duration.total_seconds() % 60)
        
        st.markdown(f"â±ï¸ **Session :** {minutes}m {seconds}s")
        st.markdown(f"ğŸ“… **Date :** {datetime.now().strftime('%d/%m/%Y')}")
        st.markdown(f"ğŸ• **Heure :** {datetime.now().strftime('%H:%M:%S')}")
        
        st.markdown("---")
        
        # Statistiques rapides
        st.markdown("### ğŸ“ˆ AperÃ§u rapide")
        
        # MÃ©triques simulÃ©es
        st.metric(
            label="ğŸ“Š Pages vues",
            value="1,234",
            delta="12%"
        )
        
        st.metric(
            label="ğŸ‘¥ Utilisateurs actifs",
            value="56",
            delta="-3%"
        )
        
        st.metric(
            label="âš¡ Performance",
            value="98%",
            delta="2%"
        )
        
        st.markdown("---")
        
        # Actions rapides
        st.markdown("### âš¡ Actions rapides")
        
        col1, col2 = st.columns(2)
        
        with col1:
            if st.button("ğŸ”„", help="Actualiser les donnÃ©es"):
                st.rerun()
        
        with col2:
            if st.button("ğŸ“¥", help="Exporter les donnÃ©es"):
                st.success("Export dÃ©marrÃ© !")
        
        # Bouton de dÃ©connexion simulÃ©
        if st.button("ğŸšª DÃ©connexion", type="secondary", use_container_width=True):
            # RÃ©initialiser la session
            for key in list(st.session_state.keys()):
                del st.session_state[key]
            st.success("DÃ©connexion rÃ©ussie !")
            st.rerun()
        
        st.markdown("---")
        
        # Section d'aide
        with st.expander("â“ Aide & Support"):
            st.markdown("""
            **ğŸ†˜ Besoin d'aide ?**
            
            - ğŸ“š Consultez la documentation
            - ğŸ’¬ Contactez le support : {{ author_email }}
            - ğŸ› Signaler un bug
            - ğŸ’¡ SuggÃ©rer une amÃ©lioration
            
            **ğŸ“ Formation complÃ¨te**
            
            Ce template dÃ©mo vous plaÃ®t ? 
            DÃ©couvrez la version complÃ¨te avec :
            - Tests automatisÃ©s
            - DÃ©ploiement cloud
            - Base de donnÃ©es
            - Authentification
            - Et bien plus !
            
            ğŸ‘‰ [En savoir plus](https://votre-lien-formation.com)
            """)
        
        # Footer de la sidebar
        st.markdown("---")
        st.markdown(
            "<div style='text-align: center; font-size: 0.8em; color: gray;'>"
            f"v1.0.0 | DÃ©veloppÃ© avec â¤ï¸<br>"
            f"par {{ author_name }}"
            "</div>", 
            unsafe_allow_html=True
        )


def render_mini_sidebar():
    """Version minimaliste de la sidebar pour les pages spÃ©cifiques."""
    with st.sidebar:
        st.markdown("### ğŸš€ {{ project_name }}")
        st.markdown("---")
        
        # Retour Ã  l'accueil
        if st.button("ğŸ  Retour Ã  l'accueil"):
            st.switch_page("main.py")
        
        # Informations essentielles
        st.markdown(f"ğŸ‘¤ {{ author_name }}")
        st.markdown(f"ğŸ“… {datetime.now().strftime('%d/%m/%Y')}")


if __name__ == "__main__":
    # Test du composant
    st.set_page_config(page_title="Test Sidebar", layout="wide")
    st.title("Test du composant Sidebar")
    render_sidebar()
    st.write("Contenu principal de la page...")